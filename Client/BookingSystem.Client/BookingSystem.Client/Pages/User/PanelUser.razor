@page "/userPanel"
@using BookingSystem.Applications.DTOs
@using BookingSystem.Domain.Enums
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization
@attribute [Authorize(Roles = "Client")]
@inject HttpClient Http
@inject AuthenticationStateProvider AuthStateProvider
@inject NavigationManager NavManager
@inject ILocalStorageService LocalStorage


<MudTabs @bind-ActivePanelIndex="activeTab">
    <MudTabPanel Text="رزروهای جاری">
        <MudGrid>
            @foreach (var booking in ActiveBookings)
            {
                <MudItem xs="12" sm="6" md="4">
                    <MudCard>
                        <MudCardHeader>
                            <MudText Typo="Typo.subtitle1">@booking.ServiceTitle</MudText>
                            <MudText Typo="Typo.caption">@booking.StartTime.ToShortDateString()- @booking.EndTime</MudText>
                        </MudCardHeader>
                        <MudCardContent>
                            <MudText>وضعیت: @booking.Status</MudText>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="@(() => ViewBooking(booking.Id))">مشاهده</MudButton>
                            <MudButton Variant="Variant.Outlined" Color="Color.Secondary" OnClick="@(() => EditBooking(booking.Id))">ویرایش</MudButton>
                            <MudButton Variant="Variant.Text" Color="Color.Error" OnClick="@(() => CancelBooking(booking.Id))">لغو</MudButton>
                        </MudCardActions>
                    </MudCard>
                </MudItem>
            }
        </MudGrid>
    </MudTabPanel>

    <MudTabPanel Text="تاریخچه رزروها">
        <MudGrid>
            @foreach (var booking in BookingHistory)
            {
                <MudItem xs="12" sm="6" md="4">
                    <MudCard>
                        <MudCardHeader>
                            <MudText Typo="Typo.subtitle1">@booking.ServiceTitle</MudText>
                            <MudText Typo="Typo.caption">@booking.StartTime.ToShortDateString() - @booking.EndTime</MudText>
                        </MudCardHeader>
                        <MudCardContent>
                            <MudText>وضعیت: @booking.Status</MudText>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="@(() => ViewBooking(booking.Id))">مشاهده</MudButton>
                        </MudCardActions>
                    </MudCard>
                </MudItem>
            }
        </MudGrid>
    </MudTabPanel>
</MudTabs>